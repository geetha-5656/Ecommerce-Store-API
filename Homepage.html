<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ecommerce</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="homepage.css">
</head>
<body>
<!-- navigation bar -->
<header class="navbar">
    <div class="logo">
    <a href="Homepage.html">Ecommerce</a>
    </div>

    <div class="hamburger">
        <i class="fa fa-bars"></i>
    </div>

 <nav>
        <a href="Homepage.html">Home</a>
        <a href="Products.html">Products</a>
        <a href="About.html">About</a>
        <a href="contact.html">Contact</a>
        
    </nav>

<div class="icons desktop-icons">
        <button class="btn"><i class="fa-solid fa-right-to-bracket"></i><a href="Login.html"> Login</a></button>
        <button class="btn"><i class="fa-solid fa-user-plus"></i><a href="Register.html">Register</a> </button>
        <button class="btn cart"><i class="fa-solid fa-cart-shopping"></i><a href="cart.html">Cart (0)</a> </button>
    </div>

</header>

<section class="hero">
    <div class="hero-content">
        <h1>New Season Arrivals</h1>
        <p>This is a wider card with supporting text below as a natural lead-in to additional content. 
           This content is a little bit longer.</p>
    </div>
</section>

<section class="products-section">
    <h2>Latest Products</h2>
    <div class="product-filters">
        <button class="filter-btn active">All</button>
        <button class="filter-btn">Men's Clothing</button>
        <button class="filter-btn">Women's Clothing</button>
        <button class="filter-btn">Jewelry</button>
        <button class="filter-btn">Electronics</button>
    </div>
</section>

<div class="product-container" id="productContainer"></div>

<footer class="footer">
    Made with ❤️ by Geetha
</footer>

<script>
const productContainer = document.getElementById("productContainer");
let allProducts = [];

// Fetch products
async function loadProducts() {
    const response = await fetch("https://fakestoreapi.com/products");
    allProducts = await response.json();
    displayProducts(allProducts);
}

// Display products
function displayProducts(products) {
    productContainer.innerHTML = products.map(product => `
        <div class="product-card">
            <img src="${product.image}" alt="${product.title}">
            <h3>${product.title.slice(0, 18)}...</h3>
            <p>${product.description.slice(0, 60)}...</p>
            <div class="product-price">$ ${product.price}</div>
            <div class="card-btns">
                <button>Details</button>
                <button onclick='addToCart(${product.id}, ${JSON.stringify(product.title)}, ${product.price}, ${JSON.stringify(product.image)})'>Add to Cart</button>
            </div>
        </div>
    `).join("");
}

// Filter the products [all,men,women,jewelery,electronics]
document.querySelectorAll(".filter-btn").forEach(btn => {
    btn.addEventListener("click", () => {

        // Active Class Toggle
        document.querySelector(".filter-btn.active")?.classList.remove("active");
        btn.classList.add("active");

        const category = btn.textContent.trim();
        
        if (category === "All") {
            displayProducts(allProducts);
        } 
        else if (category.includes("Men")) {
            displayProducts(allProducts.filter(p => p.category === "men's clothing"));
        } 
        else if (category.includes("Women")) {
            displayProducts(allProducts.filter(p => p.category === "women's clothing"));
        } 
        else if (category.includes("Jewelry")) {
            displayProducts(allProducts.filter(p => p.category === "jewelery"));
        } 
        else if (category.includes("Electronics")) {
            displayProducts(allProducts.filter(p => p.category === "electronics"));
        }
    });
});

loadProducts();
updateCartCount();

// Adding to cart function
function addToCart(id, title, price, image) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    const existingItem = cart.find(item => item.id === id);

    if (existingItem) {
        existingItem.quantity += 1;
        alert('This product is already in the cart');
    } else {
        cart.push({ id, title, price, image, quantity: 1 });
        alert('Product added to cart!');
    }

    localStorage.setItem('cart', JSON.stringify(cart));
    updateCartCount();
}

// Update cart count 
function updateCartCount() {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const cartCount = cart.reduce((total, item) => total + item.quantity, 0);
    const cartBtn = document.querySelector('.btn a[href="cart.html"]');
    if (cartBtn) {
        cartBtn.textContent = `Cart(${cartCount})`;
    }
}

// Hamburger menu toggle
const hamburger = document.querySelector('.hamburger');
const nav = document.querySelector('nav');

hamburger.addEventListener('click', () => {
    nav.classList.toggle('active');
});
</script>

</body>
</html>
